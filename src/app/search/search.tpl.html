
<header class=" relative cover overflow-hidden white-text search-banner" data-ui-component="header-area">
  <div class="container-fluid">

    <div class="row">
      <div class="col-12 left mt4 ml4 mb4">
        <a ui-sref="home"><img src="assets/logo-main.png"></a>
      </div>
    </div>
  </div>
</header>

<div ng-controller="SearchCtrl as searchCtrl">
  <div>
    <a ui-sref="home" class="lh25 px2">Home</a>
  </div>
<!-------------------- Search Filters -------------------->
  <cc-menu cc-placement="left" cc-start-open="true" cc-width="340px">

    <form name="refineSearch" ng-submit="searchCtrl.submitRefineSearch(searchCtrl.terms)" novalidate>

      <div class="card mt0 mb2 mr2 ml2">

        <div class="bold blue-background-md lh35 px2" ng-if="searchCtrl.aggs.departments.buckets">Department</div>

        <ul>
          <li class="no-bullet py2">
            <div ng-repeat="department in searchCtrl.aggs.departments.buckets" class="lh20 regular">
              <input type="checkbox" checklist-model="searchCtrl.dept_sel" checklist-value="department.key"
                                                                          ng-model= "searchCtrl.dept_sel" >
              <label class="regular">{{department.key}}</label>

              <ul>
                <li class="no-bullet">
                  <div ng-repeat="division in department.division.buckets" class="lh20 regular">
                    <input type="checkbox" checklist-model="searchCtrl.division_sel" checklist-value="division.key">
                    <label class="regular small">{{division.key}}</label>
                  </div>
                </li>
              </ul>
            </div>
          </li>
        </ul>
      </div>

      <div class="card m2">
        <div class="bold blue-background-md lh35 px2" ng-if="searchCtrl.aggs.category.buckets">Category</div>
        <ul>
          <li class="no-bullet py2">
          <div ng-repeat="category in searchCtrl.aggs.category.buckets" class="ml2 lh20 regular">
            <input type="checkbox" checklist-model="searchCtrl.category_sel" checklist-value="category.key">
              <label class="regular">{{category.key}}</label>
          </div>
          </li>
        </ul>
      </div>

      <div class="card m2">
        <div class="bold blue-background-md lh35 px2" ng-if="searchCtrl.aggs.retention.buckets">Retention Type</div>
        <ul>
          <li class="no-bullet py2">
            <div ng-repeat="retention in searchCtrl.aggs.retention.buckets" class="ml2 lh20 regular">
              <input type="checkbox" checklist-model="searchCtrl.retention_sel" checklist-value="retention.key">
              <label class="regular"> {{retention.key}}</label>
            </div>
          </li>
        </ul>
      </div>

    </form>
  </cc-menu>






  <!------------ Search Result ------------------>
  <cc-content>
      <form name="mainSearch" ng-submit="searchCtrl.submitMainSearch(searchCtrl.terms)" novalidate>
      <div class="three-quarter-width absolute-center">This search embodies the City of San Francisco's commitment to transparency.
                    You can request any of the records
                    returned by this search. When possible, a link is included. If there is no link, please contact the department
                    in question using the contact information provided.</div>
      <div class="search-box-sml">
        <input required name="search" ng-model="searchCtrl.terms" type="text" size="50" maxlength="75"
          style="margin-left:10px;border-radius: 6px;" placeholder=" search ..."/>
        <button class="button yellow-gold-fade" ng-disabled="Search.$invalid"><img src="assets/search-icon-home.png"></button>
        <!-- This about where to put this link
          <a class="blue-background white-text" cc-button >Refine</a>
        -->
      </div>
      <div class="center" ng-if="searchCtrl.count > 0">
        Number of record classes that match you search: {{searchCtrl.count}}
      </div>
    </form>

      <div  ng-if="searchCtrl.results" class="px2" ng-repeat="result in searchCtrl.results">
        <h1 ng-if="result.highlight.title" class="blue-text shadow" ng-bind-html="result.highlight.title[0]"></h1>
        <h1 ng-if="!result.highlight.title"class="blue-text">{{result._source.title}}</h1>
        <table>
          <tr class="lh20">
            <td ng-if="result._source.department" class="bold p3-right vertical-align-top">Department: </td>
            <td ng-if="result.highlight.department[0]">
              <a ui-sref="agency({schedule_id:'{{result._source.schedule_id}}'})">
                <span ng-bind-html="result.highlight.department[0]"</span></a> </td>
            <td ng-if="!result.highlight.department[0]">
              <a ui-sref="agency({schedule_id:'{{result._source.schedule_id}}'})">{{result._source.department}}</a></td>
          </tr>
          <tr class="lh20">
            <td ng-if="result._source.category" class="bold p3-right vertical-align-top">Category:</td>
            <td ng-if="result.highlight.category[0]" ng-bind-html="result.highlight.category[0]"></td>
            <td ng-if="!result.highlight.category[0]">{{result._source.category}}</td>
          </tr>
          <tr class="lh20">
            <td ng-if="result._source.division" class="bold p3-right vertical-align-top">Division: </td>
            <td ng-if="result.highlight.division[0]" ng-bind-html="result.highlight.division[0]"></td>
            <td ng-if="!result.highlight.division[0]">{{result._source.division}}</td>
          </tr>
          <tr class="lh20">
            <td ng-if="result._source.contact" class="bold p3-right vertical-align-top">Contact: </td>
            <td>
                <!-- ------------- Contact ------------------- -->
                <span ng-if="result.highlight.contact[0]" ng-bind-html="result.highlight.contact[0]"></span>
                <span ng-if="!result.highlight.contact[0]">{{result._source.contact}}</span>

                <!-- ------------- Email ------------------- -->
              <span ng-if="result.highlight.email[0]" class="fa fa-envelope-o px2" ng-bind-html="result.highlight.email[0]"></span>
              <span ng-if="!result.highlight.email[0]" class="fa fa-envelope-o px2">&nbsp;{{result._source.email}}</span>

              <!-- ------------- Phone ------------------- -->
              <span ng-if="result.highlight.phone[0]" ng-bind-html="result.highlight.phone[0]" class="fa fa-phone px2"></span>
              <span ng-if="!result.highlight.phone[0]" class="fa fa-phone">&nbsp;{{result._source.phone}}</span>
            </td>
          </tr>
          <tr class="lh20">
            <td ng-if="result._source.remarks" class="bold p3-right vertical-align-top">Remarks: </td>
            <td ng-if="result.highlight.remarks[0]" ng-bind-html="result.highlight.remarks[0]"></td>
            <td ng-if="!result.highlight.remarks[0]">{{result._source.remarks}}</td>
          </tr>
          <tr class="lh40">
            <td colspan="2">
              <small>
              <span ng-if="result._source.retention">
                <span class="bold p1-right">retention type: </span>
                <span ng-if="result.highlight.retention[0]" ng-bind-html="result.highlight.retention[0]"></span>
                <span ng-if="!result.highlight.retention[0]">{{result._source.retention}}</span>
              </span>
              <span ng-if="result._source.on_site">
                <span class="bold p2-left p1-right">retained on-site: </span>
                <span ng-if="result.highlight.on_site[0]" ng-bind-html="result.highlight.on_site[0]"></span>
                <span ng-if="!result.highlight.on_site[0]">{{result._source.on_site}}</span>
              </span>
              <span ng-if="result._source.off_site">
                <span class="bold p2-left p1-right">retained off-site: </span>
                <span ng-if="result.highlight.off_site[0]" ng-bind-html="result.highlight.off_site[0]"></span>
                <span ng-if="!result.highlight.off_site[0]">{{result._source.off_site}}</span>
              <span ng-if="result._source.total">
                <span class="bold p2«»-left p1-right">total time retained: </span>
                <span ng-if="result.highlight.total[0]" ng-bind-html="result.highlight.total[0]"></span>
                <span ng-if="!result.highlight.total[0]">{{result._source.total}}</span>
            </small>
            </td>
          </tr>
        </table>
        <hr>
      </div>

      <div ng-if="searchCtrl.count == 0" class="py5 half-width horizontal-center">No results were found ...
        To see some examples of the kind of information held in the Index of Records,
        return to the <a ui-sref="home">home</a> page and click a department link.
      </div>
  </cc-content>
</div>
